;(function() {

  'use strict';

  angular.module('sauWebApp')
  .controller('ExploitedOrganismsCtrl', function ($scope, $routeParams, $q, sauAPI, region) {
    var promises;

    $scope.regionId = $routeParams.id.split(',') || 0;
    $scope.regionName = region;

    if ($scope.regionId.length > 1) {
      promises = $scope.regionId.map(function(id) {
        return sauAPI.Region.get({region: region, region_id: id}).$promise;
      });
      $q.all(promises).then(function(multiRes) {
        $scope.regionTitles = multiRes.map(function(res) {
          return res.data.title;
        });
      });

    } else {
      $scope.region = sauAPI.Region.get({region: region, region_id: $routeParams.id || 1});
    }

  });

})();
